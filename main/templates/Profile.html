{% extends 'index.html' %}

{% block title %}Profile Page{% endblock %}
{% block content %}
<style>
    .profile {
        margin: auto;
        width: 100%;
        height: 40%;
    }

    .left-box {
        float: left;
        width: 30%;
    }

    .right-box {
        float: right;
        width: 50%;
    }
</style>

<body>
    <h1>{{userid}}'s Profile</h1>
    <div class='profile'>
        <div class='left-box'>
            <div id="emoticon" style="border:2px solid black;">
                <h2>Emoticon Image</h2>
            </div>
            <p></p>
            <input type="button" value="Select Emoticon" id="selectemo">
        </div>

        <div id="value" class='right-box'>
            <p>
            <h4>아이디 : {{userid}}</h4>
            </p>
            <p>
            <h4>이름 : {{username}}</h4>
            </p>
            <p>
            <h4>전화번호 : {{userphone}}</h4>
            </p>
            <input type="button" value="Reset PW" onclick="location.href='/movetoresetpw'">
            <input type="button" value="Change" id="change">
        </div>
        <div class='right-box' id="changevalue">
            <p>
            <h4>아이디 : {{userid}}</h4>
            </p>
            <p>이름 : <input type="text" value="{{username}}" id="name"></p>
            <p>전화번호 : <input type="text" value="{{userphone}}" id="phone"></p>
            <input type="button" value="확인" id="accept" onclick="change_profile();">
            <input type="button" value="취소" id="cancel">
        </div>
    </div>

    <div class="ts-master-list">
        <h1>My Team Storage List</h1>
        <table>
            <tbody>
                {% if data %}
                {% for list in data %}
                <tr>
                    <td>
                        <h3><a href="/movetotsmaster?ts_name={{list}}">{{list}}</a></h3>
                    </td>
                </tr>
                {% endfor %}
                {% else %}
                <tr>
                    <td>{{userid}}님이 만든 Team Storage가 없습니다.</td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</body>
<script>
    $('#changevalue').hide();
    $('#selectemo').hide();

    $('#change').click(function () {
        $('#value').hide();

        $('#changevalue').show();
        $('#selectemo').show();
    });

    $('#cancel').click(function () {
        $('#changevalue').hide();
        $('#selectemo').hide();

        $('#value').show();
    });

    function change_profile() {
        var username = $('#name').val();
        var userphone = $('#phone').val();

        if (confirm("정말 수정하시겠습니까?")) {
            $.ajax({
                url: "{% url 'changeprofile' %}",
                type: "GET",
                data: { 'username': username, 'userphone': userphone },
                success: function (result) {
                    if(result == 'success'){
                        alert("수정 완료 되었습니다.");
                        location.reload();
                    }
                },
                error: function (request, status, error) {
                    alert("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);
                }
            })
        }
    }
</script>
{% endblock %}